---
layout: post
title: 最長増加部分列（LIS）
date: 2023-04-04 09:32 +0900
category: cp
slug: cp-4
---

数列$A=(a_0,...,a_{N-1})$に関する**最長増加部分列（Longest Increasing Subsequence，LIS）**とは，$A$の連続するとは限らない部分列であって，要素が単調増加となるもののうち最長のものをいう．LISの長さは動的計画法により求めることができる．

<br>

## LISの長さを求める

2通りの解法について述べる．

※狭義単調増加のLIS長を求める．広義のものも同様にして求められる．

### 増加列の長さについてのDP

「$dp[i]:=a_i$が増加部分列の末尾であるとき，その列の長さの最大値」とすると，遷移は次のようにかける．

$$
    dp[i] = \max\{1, dp[j]+1 \, | \, j < i \land a_j < a_i\}
$$

答えは$\displaystyle\max_{i=0,...,N-1} dp[i]$である．計算量は$O(N^2)$となる．

### 増加列の末尾要素についてのDP

同じ長さの増加列であっても，その末尾の要素が小さいほうが後々有利になる．このことに着目して，「$dp[i]:=$増加部分列の長さが$i+1$となるときの，末尾の要素の最小値」とする．ある要素$a_j$が，長さ$i$の列の末尾となるかを順に判定する．これを表す遷移は，

$$
    dp[i] = \min\{dp[i], a_j  \, | \, i=0 \lor dp[i-1] < a_j \}
$$

であり，答えは$(dp[i] < \textrm{INF}$を満たす最大の$i)+1$である．

これを素直に実装すると計算量は$O(N^2)$となるが，二分探索を用いることで$O(N\log{N})$まで計算量を落とすことができる．配列$dp$が常に単調増加となることより，要素$a_j$についての更新箇所（最長の長さ$i$）を二分探索により求めることができる．

<br>

## 文献

秋葉拓哉，岩田陽一，北川宜稔．『プログラミングコンテストチャレンジブック 第2版』．マイナビ出版，2012，pp. 63-65．